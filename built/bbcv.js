//     bbcv
//     (c) sf
//     bbcv is licensed under the sf terms.

define("bbcv/iterators",["require","exports","module","lodash"],function(e,i){var t=e("lodash");i.onItemViews=function(){var e=Array.prototype.slice.call(arguments);return t.each(this.modelViews,function(i){i.on.apply(i,e)}),this};var o=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];t.each(o,function(e){i[e]=function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this.modelViews),t[e].apply(t,i)}})}),define("bbcv/event-handlers",["require","exports","module","lodash","jquery"],function(e,i){e("lodash"),e("jquery");i.handleAdd=function(e){this.buildItemView(e)},i.handleRemove=function(e){this.removeView(e)},i.handleReset=function(e){this.$el.html(""),e.each(this.handleRemove),e.each(this.handleAdd)},i.handleResort=function(e,i){this.handleReset(e,i)}}),define("bbcv/model-view",["require","exports","module","lodash"],function(e,i){function t(e,i,t){var o=t.getViewAt(i-1);return o?e.insertAfter(o.$el):e.appendTo(t.$el)}var o=e("lodash");i.getModelViewAt=function(e){return this.modelViews[e]},i.getModelView=function(e){var i=e.cid;return o.find(this.modelViews,function(e){return e.model.cid===i})},i.removeModelViewAt=function(e){var i=this.modelViews.splice(e,1)[0];return i?i.remove():void 0},i.removeModelView=function(e){var i=e.cid,t=o.findIndex(this.modelViews,function(e){return e.model.cid===i});return this.removeModelViewAt(t)},i.addModelView=function(e){var i=o.isFunction(this.modelTemplate)?this.modelTemplate(e.attributes):this.modelTemplate,n=$(i),l=this.collection.indexOf(e);t(this,l,n);var r={el:n,model:e,index:l,collection:this.collection,collectionView:this},s=this.modelView(r);return this.modelViews.splice(l,0,s),s}}),define("bbcv",["require","exports","module","lowercase-backbone","bbmv","bbcv/iterators","bbcv/event-handlers","bbcv/model-view"],function(e,i,t){var o=e("lowercase-backbone").view,n=o.prototype.initialize,l=t.exports=o.extend({initialize:function(e){n.call(this,e),this.initializeBBCV(e)},initializeBBCV:function(e){e=e||{},_.assign(this,_.pick(e,instantiationOptionNames)),this.modelViews=[];var i=this.collection;if(!this.collection)throw new Error("No collection given for collection view");_.bindAll(this,["handleAdd","handleRemove","handleReset","handleResort"]),this.listenTo(i,"add",this.handleAdd).listenTo(i,"remove",this.handleRemove).listenTo(i,"reset",this.handleReset).listenTo(i,this.resortEvent,this.handleResort),this.handleReset(i)},resortEvent:"resort",modelHtml:'<div>bb-collection-view item replace "modelHtml" property</div>',modelView:e("bbmv")});l.assignProto(e("bbcv/iterators")).assignProto(e("bbcv/event-handlers")).assignProto(e("bbcv/model-view"))});